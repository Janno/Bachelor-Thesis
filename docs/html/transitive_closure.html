<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><link href="coqdoc.css" rel="stylesheet" type="text/css"/><title>transitive_closure</title><style>
    .beautiful_section {
        padding-left: 10px;
        border-left: 3px solid #90BDFF;
        margin-bottom: 10px;
    }
    .doc_inner {
        background-color: transparent !important;
    }
    .doc_outer {
        background-color: #90BDFF;
        margin-top: 5px;
        margin-bottom: 5px;
    }
    #page-wrap {
      width: 100%;
      margin: 10px auto;
      position: relative;
    }

    #sidebar {
        width: 250px;
        position: fixed;
        right: 10px;
        margin-left: 500px;
        border: 2px solid #FFBD90;
        background-color: white;
        padding: 5px;
        font-family: sans-serif;
        text-overflow: ellipsis;
        overflow-x: hidden;
    }
    #sidebar a {
        font-size: 120%;
    }
    #sidebar ol {
        margin-left: -10px;
    }
    </style></head><body><div id="page-wrap"><div id="sidebar"><ol><li><a href="#AllButLast">AllButLast</a><ol></ol></li><li><a href="#TransitiveClosure">TransitiveClosure</a><ol><li><a href="#TransitiveClosure.Misc">Misc</a><ol></ol></li><li><a href="#TransitiveClosure.L">L</a><ol></ol></li><li><a href="#TransitiveClosure.R">R</a><ol></ol></li></ol></li></ol></div></div>
<div id="page">

<div id="main">
<h1 class="libtitle">Library transitive_closure</h1>
<section class="beautiful_section"><section class="beautiful_section"><section class="beautiful_section"><section class="beautiful_section"><section class="beautiful_section"><div class="code">
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="library">ssreflect</span> <span class="id" type="library">ssrbool</span> <span class="id" type="library">ssrnat</span> <span class="id" type="library">fintype</span> <span class="id" type="library">eqtype</span> <span class="id" type="library">seq</span> <span class="id" type="library">ssrfun</span> <span class="id" type="library">ssrbool</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="automata.html#"><span class="id" type="library">automata</span></a> <a class="idref" href="misc.html#"><span class="id" type="library">misc</span></a> <span class="id" type="library">regexp</span>.<br/>
<br/>
<span class="id" type="keyword">Set</span> <span class="id" type="keyword">Implicit</span> <span class="id" type="var">Arguments</span>.<br/>
<br/>
<br/>
<span class="id" type="keyword">Section</span> <a name="AllButLast"><span class="id" type="section">AllButLast</span></a>.<br/>
<br/>
  <span class="id" type="keyword">Variable</span> <a name="AllButLast.X"><span class="id" type="variable">X</span></a>: <span class="id" type="keyword">Type</span>.<br/>
<br/>
  <span class="id" type="keyword">Definition</span> <a name="belast"><span class="id" type="definition">belast</span></a> (<span class="id" type="var">xs</span>: <span class="id" type="inductive">seq</span> <a class="idref" href="transitive_closure.html#AllButLast.X"><span class="id" type="variable">X</span></a>) :=<br/>
    (<span class="id" type="var">fix</span> <span class="id" type="var">belast</span> <span class="id" type="var">xs</span> := <br/>
    <span class="id" type="keyword">match</span> <span class="id" type="var">xs</span> <span class="id" type="keyword">with</span><br/>
      | <span class="id" type="notation">[::]</span> =&gt; <span class="id" type="notation">[::]</span><br/>
      | <span class="id" type="notation">[::</span><span class="id" type="var">x</span><span class="id" type="notation">]</span> =&gt; <span class="id" type="notation">[::]</span><br/>
      | <span class="id" type="var">x</span><span class="id" type="notation">::</span><span class="id" type="var">xs</span> =&gt; <span class="id" type="var">x</span><span class="id" type="notation">::(</span><span class="id" type="var">belast</span> <span class="id" type="var">xs</span><span class="id" type="notation">)</span><br/>
    <span class="id" type="keyword">end</span>)<br/>
    <span class="id" type="var">xs</span>.<br/>
<br/>
  <span class="id" type="keyword">Definition</span> <a name="allbutlast"><span class="id" type="definition">allbutlast</span></a> <span class="id" type="var">p</span> : <span class="id" type="definition">pred</span> (<span class="id" type="inductive">seq</span> <a class="idref" href="transitive_closure.html#AllButLast.X"><span class="id" type="variable">X</span></a>) :=<br/>
    <span class="id" type="keyword">fun</span> <span class="id" type="var">xs</span> =&gt; <span class="id" type="definition">all</span> <span class="id" type="var">p</span> (<a class="idref" href="transitive_closure.html#belast"><span class="id" type="definition">belast</span></a> <span class="id" type="var">xs</span>).<br/>
<br/>
  <span class="id" type="keyword">Lemma</span> <a name="allbutlast_impl"><span class="id" type="lemma">allbutlast_impl</span></a> (<span class="id" type="var">p</span> <span class="id" type="var">q</span>: <span class="id" type="definition">pred</span> <a class="idref" href="transitive_closure.html#AllButLast.X"><span class="id" type="variable">X</span></a>) <span class="id" type="var">xs</span>:<br/>
    (<span class="id" type="keyword">forall</span> <span class="id" type="var">x</span>, <span class="id" type="var">p</span> <span class="id" type="var">x</span> -&gt; <span class="id" type="var">q</span> <span class="id" type="var">x</span>) -&gt;<br/>
    <a class="idref" href="transitive_closure.html#allbutlast"><span class="id" type="definition">allbutlast</span></a> <span class="id" type="var">p</span> <span class="id" type="var">xs</span> -&gt;<br/>
    <a class="idref" href="transitive_closure.html#allbutlast"><span class="id" type="definition">allbutlast</span></a> <span class="id" type="var">q</span> <span class="id" type="var">xs</span>.<br/>
  <span class="id" type="keyword">Proof</span>.<br/>
    <span class="id" type="tactic">elim</span>: <span class="id" type="var">xs</span> =&gt; [|<span class="id" type="var">x</span> <span class="id" type="var">xs</span> <span class="id" type="var">IHxs</span>].<br/>
      <span class="id" type="tactic">by</span> [].<br/>
    <span class="id" type="tactic">case</span>: <span class="id" type="var">xs</span> <span class="id" type="var">IHxs</span> =&gt; [|<span class="id" type="var">y</span> <span class="id" type="var">xs</span> <span class="id" type="var">IHxs</span>].<br/>
      <span class="id" type="tactic">by</span> [].<br/>
    <span class="id" type="tactic">rewrite</span> /<a class="idref" href="transitive_closure.html#allbutlast"><span class="id" type="definition">allbutlast</span></a> /=.<br/>
    <span class="id" type="tactic">move</span> =&gt; <span class="id" type="var">H0</span> /<span class="id" type="lemma">andP</span> [] /<span class="id" type="var">H0</span> -&gt; /=.<br/>
    <span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>: (<span class="id" type="var">IHxs</span> <span class="id" type="var">H0</span>).<br/>
  <span class="id" type="keyword">Qed</span>.<br/>
<br/>
  <span class="id" type="keyword">Lemma</span> <a name="allbutlast0"><span class="id" type="lemma">allbutlast0</span></a> <span class="id" type="var">p</span>: <a class="idref" href="transitive_closure.html#allbutlast"><span class="id" type="definition">allbutlast</span></a> <span class="id" type="var">p</span> <span class="id" type="notation">[::]</span>.<br/>
  <span class="id" type="keyword">Proof</span>. <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> /<a class="idref" href="transitive_closure.html#allbutlast"><span class="id" type="definition">allbutlast</span></a> /=. <span class="id" type="keyword">Qed</span>.<br/>
<br/>
  <span class="id" type="keyword">Lemma</span> <a name="allbutlast1"><span class="id" type="lemma">allbutlast1</span></a> <span class="id" type="var">p</span> <span class="id" type="var">x</span>: <a class="idref" href="transitive_closure.html#allbutlast"><span class="id" type="definition">allbutlast</span></a> <span class="id" type="var">p</span> <span class="id" type="notation">[::</span><span class="id" type="var">x</span><span class="id" type="notation">]</span>.<br/>
  <span class="id" type="keyword">Proof</span>. <span class="id" type="tactic">by</span> []. <span class="id" type="keyword">Qed</span>.<br/>
<br/>
  <span class="id" type="keyword">Lemma</span> <a name="allbutlast_cons"><span class="id" type="lemma">allbutlast_cons</span></a> (<span class="id" type="var">p</span>: <span class="id" type="definition">pred</span> <a class="idref" href="transitive_closure.html#AllButLast.X"><span class="id" type="variable">X</span></a>) <span class="id" type="var">x</span> <span class="id" type="var">xs</span>: <span class="id" type="var">p</span> <span class="id" type="var">x</span> -&gt; <a class="idref" href="transitive_closure.html#allbutlast"><span class="id" type="definition">allbutlast</span></a> <span class="id" type="var">p</span> <span class="id" type="var">xs</span> -&gt; <a class="idref" href="transitive_closure.html#allbutlast"><span class="id" type="definition">allbutlast</span></a> <span class="id" type="var">p</span> (<span class="id" type="var">x</span><span class="id" type="notation">::</span><span class="id" type="var">xs</span>).<br/>
  <span class="id" type="keyword">Proof</span>.<br/>
    <span class="id" type="tactic">elim</span>: <span class="id" type="var">xs</span> <span class="id" type="var">x</span> =&gt; [|<span class="id" type="var">y</span> <span class="id" type="var">xs</span> <span class="id" type="var">IHxs</span>] <span class="id" type="var">x</span> //.<br/>
    <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> /<a class="idref" href="transitive_closure.html#allbutlast"><span class="id" type="definition">allbutlast</span></a> /= =&gt; -&gt; /=.<br/>
  <span class="id" type="keyword">Qed</span>.<br/>
<br/>
  <span class="id" type="keyword">Lemma</span> <a name="allbutlast_cons'"><span class="id" type="lemma">allbutlast_cons'</span></a> <span class="id" type="var">p</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">xs</span>: <a class="idref" href="transitive_closure.html#allbutlast"><span class="id" type="definition">allbutlast</span></a> <span class="id" type="var">p</span> (<span class="id" type="var">x</span><span class="id" type="notation">::</span><span class="id" type="var">y</span><span class="id" type="notation">::</span><span class="id" type="var">xs</span>) -&gt; <span class="id" type="var">p</span> <span class="id" type="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&amp;&amp;'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="transitive_closure.html#allbutlast"><span class="id" type="definition">allbutlast</span></a> <span class="id" type="var">p</span> (<span class="id" type="var">y</span><span class="id" type="notation">::</span><span class="id" type="var">xs</span>).<br/>
  <span class="id" type="keyword">Proof</span>.<br/>
    <span class="id" type="tactic">elim</span>: <span class="id" type="var">xs</span> <span class="id" type="var">x</span> =&gt; [|<span class="id" type="var">z</span> <span class="id" type="var">xs</span> <span class="id" type="var">IHxs</span>] <span class="id" type="var">x</span> //.<br/>
  <span class="id" type="keyword">Qed</span>.<br/>
<br/>
  <span class="id" type="keyword">Lemma</span> <a name="all_allbutlast"><span class="id" type="lemma">all_allbutlast</span></a> <span class="id" type="var">p</span> <span class="id" type="var">xs</span>: <span class="id" type="definition">all</span> <span class="id" type="var">p</span> <span class="id" type="var">xs</span> -&gt; <a class="idref" href="transitive_closure.html#allbutlast"><span class="id" type="definition">allbutlast</span></a> <span class="id" type="var">p</span> <span class="id" type="var">xs</span>.<br/>
  <span class="id" type="keyword">Proof</span>.<br/>
    <span class="id" type="tactic">elim</span>: <span class="id" type="var">xs</span> =&gt; [|<span class="id" type="var">x</span> <span class="id" type="var">xs</span> <span class="id" type="var">IHxs</span>] //.<br/>
    <span class="id" type="tactic">move</span> =&gt; /= /<span class="id" type="lemma">andP</span> [] <span class="id" type="var">H0</span> /<span class="id" type="var">IHxs</span>.<br/>
    <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span>: <a class="idref" href="transitive_closure.html#allbutlast_cons"><span class="id" type="lemma">allbutlast_cons</span></a>.<br/>
  <span class="id" type="keyword">Qed</span>.<br/>
<br/>
  <span class="id" type="keyword">Lemma</span> <a name="allbutlast_cons''"><span class="id" type="lemma">allbutlast_cons''</span></a> <span class="id" type="var">p</span> <span class="id" type="var">x</span> (<span class="id" type="var">xs</span>: <span class="id" type="inductive">seq</span> <a class="idref" href="transitive_closure.html#AllButLast.X"><span class="id" type="variable">X</span></a>): <a class="idref" href="transitive_closure.html#allbutlast"><span class="id" type="definition">allbutlast</span></a> <span class="id" type="var">p</span> (<span class="id" type="var">x</span><span class="id" type="notation">::</span><span class="id" type="var">xs</span>) -&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">(</span></a><span class="id" type="definition">size</span> <span class="id" type="var">xs</span> <span class="id" type="notation">==</span> 0<a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">||</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">p</span> <span class="id" type="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&amp;&amp;'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="transitive_closure.html#allbutlast"><span class="id" type="definition">allbutlast</span></a> <span class="id" type="var">p</span> <span class="id" type="var">xs</span><a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">)</span></a>.<br/>
  <span class="id" type="keyword">Proof</span>.<br/>
    <span class="id" type="tactic">elim</span>: <span class="id" type="var">xs</span> <span class="id" type="var">x</span> =&gt; [|<span class="id" type="var">y</span> <span class="id" type="var">xs</span> <span class="id" type="var">IHxs</span>] <span class="id" type="var">x</span>.<br/>
      <span class="id" type="tactic">by</span> [].<br/>
    <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">orFb</span>.<br/>
  <span class="id" type="keyword">Qed</span>.<br/>
<br/>
  <span class="id" type="keyword">Lemma</span> <a name="all_allbutlast_cat"><span class="id" type="lemma">all_allbutlast_cat</span></a> <span class="id" type="var">p</span> <span class="id" type="var">xs</span> <span class="id" type="var">ys</span>: <span class="id" type="definition">all</span> <span class="id" type="var">p</span> <span class="id" type="var">xs</span> -&gt; <a class="idref" href="transitive_closure.html#allbutlast"><span class="id" type="definition">allbutlast</span></a> <span class="id" type="var">p</span> <span class="id" type="var">ys</span> -&gt; <a class="idref" href="transitive_closure.html#allbutlast"><span class="id" type="definition">allbutlast</span></a> <span class="id" type="var">p</span> (<span class="id" type="var">xs</span><span class="id" type="notation">++</span><span class="id" type="var">ys</span>).<br/>
  <span class="id" type="keyword">Proof</span>.<br/>
    <span class="id" type="tactic">elim</span>: <span class="id" type="var">xs</span> =&gt; [|<span class="id" type="var">x</span> <span class="id" type="var">xs</span> <span class="id" type="var">IHxs</span>].<br/>
      <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> /= =&gt; <span class="id" type="var">_</span>.<br/>
    <span class="id" type="tactic">rewrite</span> /= =&gt; /<span class="id" type="lemma">andP</span> [] <span class="id" type="var">H0</span>.<br/>
    <span class="id" type="tactic">move</span> =&gt; <span class="id" type="var">H1</span> <span class="id" type="var">H2</span>. <span class="id" type="tactic">move</span>: (<span class="id" type="var">IHxs</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span>).<br/>
    <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span>: <a class="idref" href="transitive_closure.html#allbutlast_cons"><span class="id" type="lemma">allbutlast_cons</span></a>.<br/>
  <span class="id" type="keyword">Qed</span>.<br/>
<br/>
  <span class="id" type="keyword">Lemma</span> <a name="allbutlast_last"><span class="id" type="lemma">allbutlast_last</span></a> <span class="id" type="var">p</span> <span class="id" type="var">x</span> <span class="id" type="var">xs</span>: <a class="idref" href="transitive_closure.html#allbutlast"><span class="id" type="definition">allbutlast</span></a> <span class="id" type="var">p</span> <span class="id" type="var">xs</span> -&gt; <span class="id" type="var">p</span> (<span class="id" type="definition">last</span> <span class="id" type="var">x</span> <span class="id" type="var">xs</span>) -&gt; <span class="id" type="definition">all</span> <span class="id" type="var">p</span> <span class="id" type="var">xs</span>.<br/>
  <span class="id" type="keyword">Proof</span>.<br/>
    <span class="id" type="tactic">elim</span>: <span class="id" type="var">xs</span> <span class="id" type="var">x</span> =&gt; [|<span class="id" type="var">y</span> <span class="id" type="var">xs</span> <span class="id" type="var">IHxs</span>] <span class="id" type="var">x</span> //.<br/>
    <span class="id" type="tactic">case</span>: <span class="id" type="var">xs</span> <span class="id" type="var">IHxs</span> =&gt; [|<span class="id" type="var">z</span> <span class="id" type="var">xs</span>] <span class="id" type="var">IHxs</span>.<br/>
      <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> /<a class="idref" href="transitive_closure.html#allbutlast"><span class="id" type="definition">allbutlast</span></a> /= =&gt; -&gt; -&gt;.<br/>
    <span class="id" type="tactic">move</span>/<a class="idref" href="transitive_closure.html#allbutlast_cons'"><span class="id" type="lemma">allbutlast_cons'</span></a>/<span class="id" type="lemma">andP</span> =&gt; [] <span class="id" type="var">H0</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span>.<br/>
    <span class="id" type="tactic">move</span>: (<span class="id" type="var">IHxs</span> <span class="id" type="var">x</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span>).<br/>
    <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> /= <span class="id" type="var">H0</span> =&gt; /<span class="id" type="lemma">andP</span> [] -&gt;.<br/>
  <span class="id" type="keyword">Qed</span>.<br/>
<br/>
  <span class="id" type="keyword">Lemma</span> <a name="allbutlast_pred0"><span class="id" type="lemma">allbutlast_pred0</span></a> <span class="id" type="var">p</span> <span class="id" type="var">xs</span>: <span class="id" type="var">p</span> <span class="id" type="notation">=1</span> <span class="id" type="definition">pred0</span> -&gt; <a class="idref" href="transitive_closure.html#allbutlast"><span class="id" type="definition">allbutlast</span></a> <span class="id" type="var">p</span> <span class="id" type="var">xs</span> -&gt; <span class="id" type="definition">size</span> <span class="id" type="var">xs</span> <span class="id" type="notation">&lt;=</span> 1.<br/>
  <span class="id" type="keyword">Proof</span>.<br/>
    <span class="id" type="tactic">move</span> =&gt; <span class="id" type="var">H0</span>.<br/>
    <span class="id" type="tactic">elim</span>: <span class="id" type="var">xs</span> =&gt; [|<span class="id" type="var">x</span> <span class="id" type="var">xs</span> <span class="id" type="var">IHxs</span>] //.<br/>
    <span class="id" type="tactic">case</span>: <span class="id" type="var">xs</span> <span class="id" type="var">IHxs</span> =&gt; [|<span class="id" type="var">y</span> <span class="id" type="var">xs</span>] <span class="id" type="var">IHxs</span> //.<br/>
    <span class="id" type="tactic">move</span>/<a class="idref" href="transitive_closure.html#allbutlast_cons'"><span class="id" type="lemma">allbutlast_cons'</span></a>.<br/>
    <span class="id" type="tactic">move</span>/<span class="id" type="lemma">andP</span>=&gt;[].<br/>
    <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> (<span class="id" type="var">H0</span> <span class="id" type="var">x</span>).<br/>
  <span class="id" type="keyword">Qed</span>.<br/>
<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="transitive_closure.html#AllButLast"><span class="id" type="section">AllButLast</span></a>.<br/>
<br/>
<span class="id" type="keyword">Section</span> <a name="TransitiveClosure"><span class="id" type="section">TransitiveClosure</span></a>.<br/>
<br/>
  <span class="id" type="keyword">Variable</span> <a name="TransitiveClosure.char"><span class="id" type="variable">char</span></a>: <span class="id" type="abbreviation">finType</span>.<br/>
  <span class="id" type="keyword">Variable</span> <a name="TransitiveClosure.A"><span class="id" type="variable">A</span></a>: <a class="idref" href="automata.html#dfa"><span class="id" type="record">dfa</span></a> <a class="idref" href="transitive_closure.html#TransitiveClosure.char"><span class="id" type="variable">char</span></a>.<br/>
<br/>
    <span class="id" type="keyword">Section</span> <a name="TransitiveClosure.Misc"><span class="id" type="section">Misc</span></a>.<br/>
      <span class="id" type="keyword">Lemma</span> <a name="Plus_dist"><span class="id" type="lemma">Plus_dist</span></a> <span class="id" type="var">r</span> <span class="id" type="var">s</span> (<span class="id" type="var">w</span>: <span class="id" type="definition">word</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.char"><span class="id" type="variable">char</span></a>): <span class="id" type="var">w</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <span class="id" type="constructor">Plus</span> <span class="id" type="var">r</span> <span class="id" type="var">s</span> <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">w</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <span class="id" type="var">r</span><a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">||</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">w</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <span class="id" type="var">s</span><a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">)</span></a>.<br/>
      <span class="id" type="keyword">Proof</span>. <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -<span class="id" type="lemma">topredE</span>. <span class="id" type="keyword">Qed</span>.<br/>
<br/>
      <span class="id" type="keyword">Lemma</span> <a name="foldr_Plus"><span class="id" type="lemma">foldr_Plus</span></a> <span class="id" type="var">r</span> <span class="id" type="var">rs</span> (<span class="id" type="var">w</span>: <span class="id" type="definition">word</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.char"><span class="id" type="variable">char</span></a>):<br/>
        <span class="id" type="var">w</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <span class="id" type="definition">foldr</span> (@<span class="id" type="constructor">Plus</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.char"><span class="id" type="variable">char</span></a>) <span class="id" type="var">r</span> <span class="id" type="var">rs</span> <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">w</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <span class="id" type="var">r</span><a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'||'_x"><span class="id" type="notation">||</span></a> <span class="id" type="definition">has</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">r</span> =&gt; <span class="id" type="var">w</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <span class="id" type="var">r</span>) <span class="id" type="var">rs</span>.<br/>
      <span class="id" type="keyword">Proof</span>.<br/>
        <span class="id" type="tactic">elim</span>: <span class="id" type="var">rs</span> <span class="id" type="var">r</span> =&gt; [|<span class="id" type="var">s</span> <span class="id" type="var">rs</span> <span class="id" type="var">IHrs</span>] <span class="id" type="var">r</span> /=.<br/>
          <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">orbF</span>.<br/>
        <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">orbCA</span> -<span class="id" type="var">IHrs</span>.<br/>
        <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -<span class="id" type="lemma">topredE</span> -<span class="id" type="lemma">topredE</span>.<br/>
      <span class="id" type="keyword">Qed</span>.<br/>
    <span class="id" type="keyword">End</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.Misc"><span class="id" type="section">Misc</span></a>.<br/>
<br/>
  <span class="id" type="keyword">Lemma</span> <a name="minn_to_ord"><span class="id" type="lemma">minn_to_ord</span></a> <span class="id" type="var">m</span> <span class="id" type="var">n</span>: <span class="id" type="definition">minn</span> <span class="id" type="var">m</span> <span class="id" type="var">n</span> <span class="id" type="notation">&lt;=</span> <span class="id" type="var">n</span>.<br/>
  <span class="id" type="keyword">Proof</span>. <span class="id" type="tactic">elim</span>: <span class="id" type="var">n</span> <span class="id" type="var">m</span> =&gt; [|<span class="id" type="var">n</span> <span class="id" type="var">IHn</span>] <span class="id" type="var">m</span> /=.<br/>
    <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> /<span class="id" type="definition">minn</span>.<br/>
    <span class="id" type="tactic">rewrite</span> /<span class="id" type="definition">minn</span>.<br/>
    <span class="id" type="var">case_eq</span> (<span class="id" type="var">m</span> <span class="id" type="notation">&lt;</span> <span class="id" type="var">n</span><span class="id" type="notation">.+1</span>).<br/>
    <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span>: <span class="id" type="lemma">ltnW</span>.<br/>
    <span class="id" type="tactic">move</span> =&gt; <span class="id" type="var">_</span>. <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span>: <span class="id" type="lemma">ltnSn</span>.<br/>
  <span class="id" type="keyword">Qed</span>.<br/>
<br/>
  <span class="id" type="keyword">Lemma</span> <a name="leq_ltn_gt0"><span class="id" type="lemma">leq_ltn_gt0</span></a> <span class="id" type="var">n</span> <span class="id" type="var">m</span>: <span class="id" type="var">m</span> <span class="id" type="notation">&gt;</span> 0 -&gt; <span class="id" type="var">n</span> <span class="id" type="notation">&lt;=</span> <span class="id" type="var">m</span><span class="id" type="notation">.-1</span> -&gt; <span class="id" type="var">n</span> <span class="id" type="notation">&lt;</span> <span class="id" type="var">m</span>.<br/>
  <span class="id" type="keyword">Proof</span>. <span class="id" type="tactic">elim</span>: <span class="id" type="var">m</span> <span class="id" type="var">n</span> =&gt; [|<span class="id" type="var">m</span> <span class="id" type="var">IHm</span>] <span class="id" type="var">n</span> //=. <span class="id" type="keyword">Qed</span>.<br/>
<br/>
  <span class="id" type="keyword">Lemma</span> <a name="A_has_states"><span class="id" type="lemma">A_has_states</span></a>: <span class="id" type="notation">#|</span><a class="idref" href="transitive_closure.html#TransitiveClosure.A"><span class="id" type="variable">A</span></a><span class="id" type="notation">|</span> <span class="id" type="notation">&gt;</span> 0.<br/>
  <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">card_gt0P</span>.<br/>
  <span class="id" type="tactic">by</span> <span class="id" type="var">exists</span> (<a class="idref" href="automata.html#dfa_s0"><span class="id" type="projection">dfa_s0</span></a> <a class="idref" href="transitive_closure.html#TransitiveClosure.A"><span class="id" type="variable">A</span></a>).<br/>
  <span class="id" type="keyword">Qed</span>.<br/>
<br/>
  <span class="id" type="keyword">Definition</span> <a name="k_ord"><span class="id" type="definition">k_ord</span></a> <span class="id" type="var">k</span> := <br/>
    <span class="id" type="constructor">Ordinal</span> (<a class="idref" href="transitive_closure.html#leq_ltn_gt0"><span class="id" type="lemma">leq_ltn_gt0</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <a class="idref" href="transitive_closure.html#A_has_states"><span class="id" type="lemma">A_has_states</span></a> (<a class="idref" href="transitive_closure.html#minn_to_ord"><span class="id" type="lemma">minn_to_ord</span></a> <span class="id" type="var">k</span> <span class="id" type="notation">#|</span><a class="idref" href="transitive_closure.html#TransitiveClosure.A"><span class="id" type="variable">A</span></a><span class="id" type="notation">|</span><span class="id" type="notation">.-1</span>)).<br/>
<br/>
  <span class="id" type="keyword">Lemma</span> <a name="k_ord_lt"><span class="id" type="lemma">k_ord_lt</span></a> <span class="id" type="var">k</span>: <a class="idref" href="transitive_closure.html#k_ord"><span class="id" type="definition">k_ord</span></a> <span class="id" type="var">k</span> <span class="id" type="notation">&lt;</span> <span class="id" type="var">k</span><span class="id" type="notation">.+1</span>.<br/>
  <span class="id" type="keyword">Proof</span>.<br/>
    <span class="id" type="tactic">rewrite</span> /<a class="idref" href="transitive_closure.html#k_ord"><span class="id" type="definition">k_ord</span></a> /=.<br/>
    <span class="id" type="var">case_eq</span> (<span class="id" type="var">k</span> <span class="id" type="notation">&lt;=</span> <span class="id" type="notation">#|</span><a class="idref" href="transitive_closure.html#TransitiveClosure.A"><span class="id" type="variable">A</span></a><span class="id" type="notation">|</span><span class="id" type="notation">.-1</span>) =&gt; <span class="id" type="var">H0</span>.<br/>
      <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">minnl</span> =&gt; //.<br/>
    <span class="id" type="tactic">move</span>: (<span class="id" type="lemma">leq_total</span> <span class="id" type="var">k</span> <span class="id" type="notation">#|</span><a class="idref" href="transitive_closure.html#TransitiveClosure.A"><span class="id" type="variable">A</span></a><span class="id" type="notation">|</span><span class="id" type="notation">.-1</span>).<br/>
    <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H0</span> /= =&gt; <span class="id" type="var">H1</span>.<br/>
    <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">minnr</span>.<br/>
  <span class="id" type="keyword">Qed</span>.<br/>
<br/>
  <span class="id" type="keyword">Fixpoint</span> <a name="R"><span class="id" type="definition">R</span></a> (<span class="id" type="var">k</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>) (<span class="id" type="var">i</span> <span class="id" type="var">j</span>: <span class="id" type="notation">'</span><span class="id" type="notation">I_</span><span class="id" type="notation">#|</span><a class="idref" href="transitive_closure.html#TransitiveClosure.A"><span class="id" type="variable">A</span></a><span class="id" type="notation">|</span>) : <span class="id" type="inductive">regular_expression</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.char"><span class="id" type="variable">char</span></a> :=<br/>
    <span class="id" type="keyword">match</span> <span class="id" type="var">k</span> <span class="id" type="keyword">with</span><br/>
      |   0  =&gt; <br/>
            <span class="id" type="keyword">let</span> <span class="id" type="var">r</span> := <span class="id" type="definition">foldr</span> (@<span class="id" type="constructor">Plus</span> <span class="id" type="var">_</span>) (<span class="id" type="constructor">Void</span> <span class="id" type="var">_</span>) (<span class="id" type="definition">map</span> (@<span class="id" type="constructor">Atom</span> <span class="id" type="var">_</span>) (<span class="id" type="definition">filter</span> <span class="id" type="notation">[</span><span class="id" type="notation">pred</span> <span class="id" type="var">a</span> <span class="id" type="notation">|</span> <a class="idref" href="automata.html#dfa_step"><span class="id" type="projection">dfa_step</span></a> <a class="idref" href="transitive_closure.html#TransitiveClosure.A"><span class="id" type="variable">A</span></a> (<span class="id" type="definition">enum_val</span> <span class="id" type="var">i</span>) <span class="id" type="var">a</span> <span class="id" type="notation">==</span> <span class="id" type="notation">(</span><span class="id" type="definition">enum_val</span> <span class="id" type="var">j</span><span class="id" type="notation">)</span><span class="id" type="notation">]</span> (<span class="id" type="abbreviation">enum</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.char"><span class="id" type="variable">char</span></a>))) <span class="id" type="keyword">in</span><br/>
              <span class="id" type="keyword">if</span> <span class="id" type="var">i</span> <span class="id" type="notation">==</span> <span class="id" type="var">j</span> <span class="id" type="keyword">then</span> <span class="id" type="constructor">Plus</span> <span class="id" type="var">r</span> (<span class="id" type="constructor">Eps</span> <span class="id" type="var">_</span>) <span class="id" type="keyword">else</span> <span class="id" type="var">r</span><br/>
      | <span class="id" type="var">k</span><span class="id" type="notation">.+1</span> =&gt;<br/>
          <span class="id" type="keyword">let</span> <span class="id" type="var">k'</span> := <a class="idref" href="transitive_closure.html#k_ord"><span class="id" type="definition">k_ord</span></a> <span class="id" type="var">k</span> <span class="id" type="keyword">in</span><br/>
            <span class="id" type="constructor">Plus</span> (<br/>
                <span class="id" type="constructor">Conc</span> (<a class="idref" href="transitive_closure.html#R"><span class="id" type="definition">R</span></a> <span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">k'</span>)<br/>
                     (<span class="id" type="constructor">Conc</span> (<span class="id" type="constructor">Star</span> (<a class="idref" href="transitive_closure.html#R"><span class="id" type="definition">R</span></a> <span class="id" type="var">k</span> <span class="id" type="var">k'</span> <span class="id" type="var">k'</span>)) (<a class="idref" href="transitive_closure.html#R"><span class="id" type="definition">R</span></a> <span class="id" type="var">k</span> <span class="id" type="var">k'</span> <span class="id" type="var">j</span>))<br/>
              )<br/>
                 (<a class="idref" href="transitive_closure.html#R"><span class="id" type="definition">R</span></a> <span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span>)<br/>
    <span class="id" type="keyword">end</span>.<br/>
<br/>
  <span class="id" type="var">Notation </span><a name="TransitiveClosure.::'R^'_x"><span class="id" type="notation">"</span></a>'R^' k" := (<a class="idref" href="transitive_closure.html#R"><span class="id" type="definition">R</span></a> <span class="id" type="var">k</span>) (<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 8).<br/>
<br/>
  <span class="id" type="keyword">Definition</span> <a name="L"><span class="id" type="definition">L</span></a> :=<br/>
    <span class="id" type="notation">[</span><span class="id" type="keyword">fun</span> <span class="id" type="var">k</span><span class="id" type="notation">:</span> <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a> <span class="id" type="notation">=&gt;</span><br/>
       <span class="id" type="notation">[</span><span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span><span class="id" type="notation">:</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.A"><span class="id" type="variable">A</span></a> <span class="id" type="notation">=&gt;</span><br/>
          <span class="id" type="notation">[</span><span class="id" type="notation">pred</span> <span class="id" type="var">w</span> <span class="id" type="notation">|</span> <br/>
           <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&amp;&amp;'_x"><span class="id" type="notation">(</span></a><span class="id" type="definition">last</span> <span class="id" type="var">x</span> (<a class="idref" href="automata.html#dfa_run'"><span class="id" type="definition">dfa_run'</span></a> <a class="idref" href="transitive_closure.html#TransitiveClosure.A"><span class="id" type="variable">A</span></a> <span class="id" type="var">x</span> <span class="id" type="var">w</span>) <span class="id" type="notation">==</span> <span class="id" type="var">y</span><a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&amp;&amp;'_x"><span class="id" type="notation">)</span></a><br/>
             <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&amp;&amp;'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="transitive_closure.html#allbutlast"><span class="id" type="definition">allbutlast</span></a> (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> =&gt; <span class="id" type="definition">enum_rank</span> <span class="id" type="var">x</span> <span class="id" type="notation">&lt;</span> <span class="id" type="var">k</span>) (<a class="idref" href="automata.html#dfa_run'"><span class="id" type="definition">dfa_run'</span></a> <a class="idref" href="transitive_closure.html#TransitiveClosure.A"><span class="id" type="variable">A</span></a> <span class="id" type="var">x</span> <span class="id" type="var">w</span>) <br/>
          <span class="id" type="notation">]</span><br/>
       <span class="id" type="notation">]</span><br/>
    <span class="id" type="notation">]</span>.<br/>
  <span class="id" type="var">Notation </span><a name="TransitiveClosure.::'L^'_x"><span class="id" type="notation">"</span></a>'L^' k" := (<a class="idref" href="transitive_closure.html#L"><span class="id" type="definition">L</span></a> <span class="id" type="var">k</span>) (<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 8).<br/>
<br/>
  <span class="id" type="keyword">Section</span> <a name="TransitiveClosure.L"><span class="id" type="section">L</span></a>.<br/>
    <span class="id" type="keyword">Lemma</span> <a name="L_monotone"><span class="id" type="lemma">L_monotone</span></a> <span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span> <span class="id" type="var">w</span>: <span class="id" type="var">w</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span> -&gt; <span class="id" type="var">w</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^(</span></a><span class="id" type="var">k</span><span class="id" type="notation">.+1</span><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">)</span></a> <span class="id" type="var">i</span> <span class="id" type="var">j</span>.<br/>
    <span class="id" type="keyword">Proof</span>.<br/>
      <span class="id" type="tactic">rewrite</span> 2!<span class="id" type="lemma">in_simpl</span> /= =&gt; /<span class="id" type="lemma">andP</span> [] -&gt; /=.<br/>
      <span class="id" type="tactic">apply</span>: <a class="idref" href="transitive_closure.html#allbutlast_impl"><span class="id" type="lemma">allbutlast_impl</span></a>.<br/>
      <span class="id" type="tactic">move</span> =&gt; <span class="id" type="var">x</span>.<br/>
      <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span>: (@<span class="id" type="lemma">ltnW</span> ((<span class="id" type="definition">enum_rank</span> <span class="id" type="var">x</span>)) <span class="id" type="var">k</span>).<br/>
    <span class="id" type="keyword">Qed</span>.<br/>
<br/>
    <span class="id" type="keyword">Lemma</span> <a name="L_nil"><span class="id" type="lemma">L_nil</span></a> <span class="id" type="var">k</span> <span class="id" type="var">i</span> : <span class="id" type="notation">[::]</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">i</span>.<br/>
      <span class="id" type="keyword">Proof</span>. <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">in_simpl</span> /= <span class="id" type="lemma">eq_refl</span>. <span class="id" type="keyword">Qed</span>.<br/>
<br/>
    <span class="id" type="keyword">Lemma</span> <a name="L_nil'"><span class="id" type="lemma">L_nil'</span></a> <span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span>: <span class="id" type="notation">[::]</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span> -&gt; <span class="id" type="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">j</span>.<br/>
    <span class="id" type="keyword">Proof</span>. <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">in_simpl</span> /= =&gt; /<span class="id" type="lemma">andP</span> [] /<span class="id" type="lemma">eqP</span> -&gt;. <span class="id" type="keyword">Qed</span>.<br/>
<br/>
    <span class="id" type="keyword">Lemma</span> <a name="L_cons"><span class="id" type="lemma">L_cons</span></a> <span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span> <span class="id" type="var">a</span> <span class="id" type="var">w</span>:<br/>
      <span class="id" type="notation">(</span><span class="id" type="var">a</span><span class="id" type="notation">::</span><span class="id" type="var">w</span><span class="id" type="notation">)</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span><span class="id" type="notation">.+1</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span> -&gt;<br/>
      <span class="id" type="notation">[::</span><span class="id" type="var">a</span><span class="id" type="notation">]</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span> <span class="id" type="var">i</span> (<a class="idref" href="automata.html#dfa_step"><span class="id" type="projection">dfa_step</span></a> <a class="idref" href="transitive_closure.html#TransitiveClosure.A"><span class="id" type="variable">A</span></a> <span class="id" type="var">i</span> <span class="id" type="var">a</span>) <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">/\</span></a><br/>
      <span class="id" type="var">w</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span><span class="id" type="notation">.+1</span> (<a class="idref" href="automata.html#dfa_step"><span class="id" type="projection">dfa_step</span></a> <a class="idref" href="transitive_closure.html#TransitiveClosure.A"><span class="id" type="variable">A</span></a> <span class="id" type="var">i</span> <span class="id" type="var">a</span>) <span class="id" type="var">j</span>.<br/>
    <span class="id" type="keyword">Proof</span>.<br/>
      <span class="id" type="tactic">elim</span>: <span class="id" type="var">w</span> <span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span> <span class="id" type="var">a</span> =&gt; [|<span class="id" type="var">b</span> <span class="id" type="var">w</span> <span class="id" type="var">IHw</span>] <span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span> <span class="id" type="var">a</span>.<br/>
        <span class="id" type="tactic">move</span>/(<a class="idref" href="transitive_closure.html#L_nil'"><span class="id" type="lemma">L_nil'</span></a> <span class="id" type="var">k</span>) =&gt; /= <span class="id" type="var">H0</span>.<br/>
        <span class="id" type="tactic">firstorder</span>.<br/>
          <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H0</span> <span class="id" type="lemma">in_simpl</span> /= <span class="id" type="var">H0</span> <span class="id" type="lemma">eq_refl</span>.<br/>
        <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H0</span> <span class="id" type="lemma">in_simpl</span>.<br/>
        <span class="id" type="tactic">exact</span>: <a class="idref" href="transitive_closure.html#L_nil"><span class="id" type="lemma">L_nil</span></a>.<br/>
      <span class="id" type="tactic">rewrite</span> /= <span class="id" type="lemma">in_simpl</span> /=.<br/>
      <span class="id" type="tactic">move</span>/<span class="id" type="lemma">andP</span> =&gt; [] <span class="id" type="var">H0</span> <span class="id" type="var">H1</span>.<br/>
      <span class="id" type="tactic">apply</span> <a class="idref" href="transitive_closure.html#allbutlast_cons'"><span class="id" type="lemma">allbutlast_cons'</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H1</span>.<br/>
      <span class="id" type="tactic">move</span>/<span class="id" type="lemma">andP</span>: <span class="id" type="var">H1</span> =&gt; [] <span class="id" type="var">H1</span> <span class="id" type="var">H2</span>.<br/>
      <span class="id" type="tactic">firstorder</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">in_simpl</span> /=.<br/>
        <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">eq_refl</span> /=.<br/>
      <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H0</span> <span class="id" type="var">H2</span>.<br/>
    <span class="id" type="keyword">Qed</span>.<br/>
<br/>
    <span class="id" type="keyword">Lemma</span> <a name="L_cat"><span class="id" type="lemma">L_cat</span></a> <span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">h</span> <span class="id" type="var">j</span> <span class="id" type="var">w1</span> <span class="id" type="var">w2</span>:<br/>
      <span class="id" type="definition">enum_rank</span> <span class="id" type="var">h</span> <span class="id" type="notation">&lt;</span> <span class="id" type="var">k</span> -&gt;<br/>
      <span class="id" type="var">w1</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">h</span> -&gt;<br/>
      <span class="id" type="var">w2</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span> <span class="id" type="var">h</span> <span class="id" type="var">j</span> -&gt;<br/>
      <span class="id" type="var">w1</span><span class="id" type="notation">++</span><span class="id" type="var">w2</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span>.<br/>
    <span class="id" type="keyword">Proof</span>.<br/>
      <span class="id" type="tactic">move</span> =&gt; <span class="id" type="var">H0</span> /= /<span class="id" type="lemma">andP</span> [] /<span class="id" type="lemma">eqP</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span> /<span class="id" type="lemma">andP</span> [] /<span class="id" type="lemma">eqP</span> <span class="id" type="var">H3</span> <span class="id" type="var">H4</span>.<br/>
      <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">in_simpl</span> /=.<br/>
      <span class="id" type="tactic">rewrite</span> <a class="idref" href="automata.html#dfa_run'_cat"><span class="id" type="lemma">dfa_run'_cat</span></a> <span class="id" type="var">H1</span>.<br/>
      <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">andP</span>. <span class="id" type="tactic">split</span>.<br/>
        <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">last_cat</span> <span class="id" type="var">H1</span> <span class="id" type="var">H3</span> <span class="id" type="lemma">eq_refl</span>.<br/>
      <span class="id" type="tactic">apply</span>: <a class="idref" href="transitive_closure.html#all_allbutlast_cat"><span class="id" type="lemma">all_allbutlast_cat</span></a>.<br/>
        <span class="id" type="tactic">apply</span>: <a class="idref" href="transitive_closure.html#allbutlast_last"><span class="id" type="lemma">allbutlast_last</span></a> =&gt; //.<br/>
        <span class="id" type="tactic">rewrite</span> -<span class="id" type="var">H1</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H0</span>.<br/>
        <span class="id" type="var">eassumption</span>.<br/>
      <span class="id" type="tactic">exact</span> <span class="id" type="var">H4</span>.<br/>
    <span class="id" type="keyword">Qed</span>.<br/>
<br/>
    <span class="id" type="keyword">Lemma</span> <a name="L_split"><span class="id" type="lemma">L_split</span></a> <span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span> <span class="id" type="var">a</span> <span class="id" type="var">w</span>:<br/>
      <span class="id" type="notation">(</span><span class="id" type="var">a</span><span class="id" type="notation">::</span><span class="id" type="var">w</span><span class="id" type="notation">)</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span><span class="id" type="notation">.+1</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span> -&gt;<br/>
      <span class="id" type="notation">(</span><span class="id" type="var">a</span><span class="id" type="notation">::</span><span class="id" type="var">w</span><span class="id" type="notation">)</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span> <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'\/'_x"><span class="id" type="notation">\/</span></a><br/>
      <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_','_x"><span class="id" type="notation">exists</span></a> <span class="id" type="var">w1</span><a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_','_x"><span class="id" type="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_','_x"><span class="id" type="notation">exists</span></a> <span class="id" type="var">w2</span><a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_','_x"><span class="id" type="notation">,</span></a><br/>
        <span class="id" type="var">a</span><span class="id" type="notation">::</span><span class="id" type="var">w</span> <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">w1</span> <span class="id" type="notation">++</span> <span class="id" type="var">w2</span> <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">/\</span></a><br/>
        <span class="id" type="var">w1</span> <span class="id" type="notation">!=</span> <span class="id" type="notation">[::]</span> <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">/\</span></a><br/>
        <span class="id" type="var">w1</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span> <span class="id" type="var">i</span> (<span class="id" type="definition">enum_val</span> (<a class="idref" href="transitive_closure.html#k_ord"><span class="id" type="definition">k_ord</span></a> <span class="id" type="var">k</span>)) <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">/\</span></a><br/>
        <span class="id" type="var">w2</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span><span class="id" type="notation">.+1</span> (<span class="id" type="definition">enum_val</span> (<a class="idref" href="transitive_closure.html#k_ord"><span class="id" type="definition">k_ord</span></a> <span class="id" type="var">k</span>)) <span class="id" type="var">j</span>.<br/>
    <span class="id" type="keyword">Proof</span>.<br/>
      <span class="id" type="tactic">elim</span>: <span class="id" type="var">w</span> <span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span> <span class="id" type="var">a</span> =&gt; [|<span class="id" type="var">b</span> <span class="id" type="var">w</span> <span class="id" type="var">IHw</span>] <span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span> <span class="id" type="var">a</span>.<br/>
        <span class="id" type="tactic">move</span>/<a class="idref" href="transitive_closure.html#L_cons"><span class="id" type="lemma">L_cons</span></a> =&gt; [] <span class="id" type="var">H0</span> <span class="id" type="var">H1</span>.<br/>
        <span class="id" type="tactic">rewrite</span> /= <span class="id" type="keyword">in</span> <span class="id" type="var">H0</span>.<br/>
        <span class="id" type="var">case_eq</span> (<a class="idref" href="automata.html#dfa_step"><span class="id" type="projection">dfa_step</span></a> <a class="idref" href="transitive_closure.html#TransitiveClosure.A"><span class="id" type="variable">A</span></a> <span class="id" type="var">i</span> <span class="id" type="var">a</span> <span class="id" type="notation">==</span> <span class="id" type="definition">enum_val</span> (<a class="idref" href="transitive_closure.html#k_ord"><span class="id" type="definition">k_ord</span></a> <span class="id" type="var">k</span>)) =&gt; /<span class="id" type="lemma">eqP</span> <span class="id" type="var">H2</span>.<br/>
          <span class="id" type="var">right</span>.<br/>
          <span class="id" type="var">exists</span> <span class="id" type="notation">[::</span><span class="id" type="var">a</span><span class="id" type="notation">]</span>. <span class="id" type="var">exists</span> <span class="id" type="notation">[::]</span>.<br/>
          <span class="id" type="tactic">firstorder</span>.<br/>
            <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">in_simpl</span> /= <span class="id" type="var">H2</span> <span class="id" type="lemma">eq_refl</span>.<br/>
          <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -<span class="id" type="var">H2</span> <span class="id" type="var">H1</span>.<br/>
        <span class="id" type="var">left</span>.<br/>
        <span class="id" type="tactic">move</span>/<a class="idref" href="transitive_closure.html#L_nil'"><span class="id" type="lemma">L_nil'</span></a>: <span class="id" type="var">H1</span> &lt;-.<br/>
        <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">in_simpl</span> /=.<br/>
        <span class="id" type="tactic">exact</span>: <span class="id" type="var">H0</span>.<br/>
      <span class="id" type="tactic">move</span> =&gt; <span class="id" type="var">H</span>.<br/>
      <span class="id" type="tactic">move</span>/<a class="idref" href="transitive_closure.html#L_cons"><span class="id" type="lemma">L_cons</span></a>: (<span class="id" type="var">H</span>) =&gt; [] <span class="id" type="var">H2</span>.<br/>
      <span class="id" type="tactic">move</span>/<span class="id" type="lemma">andP</span>: (<span class="id" type="var">H</span>) =&gt; [] <span class="id" type="var">H0</span> <span class="id" type="var">H1</span>.<br/>
      <span class="id" type="var">case_eq</span> (<a class="idref" href="automata.html#dfa_step"><span class="id" type="projection">dfa_step</span></a> <a class="idref" href="transitive_closure.html#TransitiveClosure.A"><span class="id" type="variable">A</span></a> <span class="id" type="var">i</span> <span class="id" type="var">a</span> <span class="id" type="notation">==</span> <span class="id" type="definition">enum_val</span> (<a class="idref" href="transitive_closure.html#k_ord"><span class="id" type="definition">k_ord</span></a> <span class="id" type="var">k</span>)) =&gt; <span class="id" type="var">H3</span>.<br/>
        <span class="id" type="tactic">move</span>/<span class="id" type="lemma">eqP</span>: <span class="id" type="var">H3</span> =&gt; <span class="id" type="var">H3</span>.<br/>
        <span class="id" type="tactic">move</span> =&gt; <span class="id" type="var">H4</span>.<br/>
        <span class="id" type="tactic">rewrite</span> -<span class="id" type="var">H3</span>.<br/>
        <span class="id" type="var">right</span>.<br/>
        <span class="id" type="tactic">by</span> <span class="id" type="var">exists</span> <span class="id" type="notation">[::</span><span class="id" type="var">a</span><span class="id" type="notation">]</span>; <span class="id" type="var">exists</span> <span class="id" type="notation">[::</span><span class="id" type="var">b</span><span class="id" type="notation">&amp;</span><span class="id" type="var">w</span><span class="id" type="notation">]</span> =&gt; //.<br/>
<br/>
      <span class="id" type="tactic">move</span>/<span class="id" type="var">IHw</span> =&gt; [].<br/>
        <span class="id" type="tactic">move</span> =&gt; <span class="id" type="var">H4</span>.<br/>
        <span class="id" type="var">left</span>.<br/>
        <span class="id" type="tactic">rewrite</span> -<span class="id" type="lemma">cat1s</span>.<br/>
        <span class="id" type="tactic">move</span>: (<a class="idref" href="transitive_closure.html#allbutlast_cons'"><span class="id" type="lemma">allbutlast_cons'</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">H1</span>) =&gt; /<span class="id" type="lemma">andP</span> [] <span class="id" type="var">H5</span> <span class="id" type="var">_</span>.<br/>
        <span class="id" type="tactic">apply</span>: (<a class="idref" href="transitive_closure.html#L_cat"><span class="id" type="lemma">L_cat</span></a> <span class="id" type="var">k</span> <span class="id" type="var">i</span> (<a class="idref" href="automata.html#dfa_step"><span class="id" type="projection">dfa_step</span></a> <a class="idref" href="transitive_closure.html#TransitiveClosure.A"><span class="id" type="variable">A</span></a> <span class="id" type="var">i</span> <span class="id" type="var">a</span>)) =&gt; //.<br/>
        <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">ltn_neqAle</span>.<br/>
        <span class="id" type="tactic">rewrite</span> -<span class="id" type="lemma">ltnS</span> <span class="id" type="var">H5</span> <span class="id" type="lemma">andbT</span>.<br/>
        <span class="id" type="var">admit</span>.<br/>
<br/>
      <span class="id" type="tactic">move</span> =&gt; [] <span class="id" type="var">w1</span> [] <span class="id" type="var">w2</span> [] <span class="id" type="var">H4</span> [] <span class="id" type="var">H5</span> [] <span class="id" type="var">H6</span> <span class="id" type="var">H7</span>.<br/>
      <span class="id" type="var">right</span>.<br/>
      <span class="id" type="var">exists</span> <span class="id" type="notation">[::</span><span class="id" type="var">a</span> <span class="id" type="notation">&amp;</span> <span class="id" type="var">w1</span><span class="id" type="notation">]</span>. <span class="id" type="var">exists</span> (<span class="id" type="var">w2</span>).<br/>
      <span class="id" type="tactic">rewrite</span> /= <span class="id" type="var">H4</span>.<br/>
      <span class="id" type="tactic">split</span> =&gt; //. <span class="id" type="tactic">split</span> =&gt; //. <span class="id" type="tactic">split</span> =&gt; //.<br/>
      <span class="id" type="tactic">rewrite</span> -<span class="id" type="lemma">cat1s</span>.<br/>
      <span class="id" type="tactic">apply</span>: <a class="idref" href="transitive_closure.html#L_cat"><span class="id" type="lemma">L_cat</span></a>; <span class="id" type="tactic">try</span> <span class="id" type="var">eassumption</span>.<br/>
      <span class="id" type="var">admit</span>.<br/>
    <span class="id" type="keyword">Qed</span>.<br/>
<br/>
    <span class="id" type="keyword">Lemma</span> <a name="L_catL"><span class="id" type="lemma">L_catL</span></a> <span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span> <span class="id" type="var">w1</span> <span class="id" type="var">w2</span>:<br/>
      <span class="id" type="var">w1</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span> <span class="id" type="var">i</span> (<span class="id" type="definition">enum_val</span> (<a class="idref" href="transitive_closure.html#k_ord"><span class="id" type="definition">k_ord</span></a> <span class="id" type="var">k</span>)) -&gt;<br/>
      <span class="id" type="var">w2</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span><span class="id" type="notation">.+1</span> (<span class="id" type="definition">enum_val</span> (<a class="idref" href="transitive_closure.html#k_ord"><span class="id" type="definition">k_ord</span></a> <span class="id" type="var">k</span>)) <span class="id" type="var">j</span> -&gt;<br/>
      <span class="id" type="var">w1</span><span class="id" type="notation">++</span><span class="id" type="var">w2</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span><span class="id" type="notation">.+1</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span>.<br/>
    <span class="id" type="keyword">Proof</span>.<br/>
      <span class="id" type="tactic">rewrite</span> /<a class="idref" href="transitive_closure.html#L"><span class="id" type="definition">L</span></a> -3!<span class="id" type="lemma">topredE</span> /=.<br/>
      <span class="id" type="tactic">rewrite</span> <a class="idref" href="automata.html#dfa_run'_cat"><span class="id" type="lemma">dfa_run'_cat</span></a>.<br/>
      <span class="id" type="tactic">move</span> =&gt; /<span class="id" type="lemma">andP</span> [] /<span class="id" type="lemma">eqP</span> <span class="id" type="var">H0</span> <span class="id" type="var">H1</span> /<span class="id" type="lemma">andP</span> [] /<span class="id" type="lemma">eqP</span> <span class="id" type="var">H2</span> <span class="id" type="var">H3</span>.<br/>
      <span class="id" type="tactic">case</span>: <span class="id" type="var">w1</span> <span class="id" type="var">H0</span> <span class="id" type="var">H1</span> =&gt; [|<span class="id" type="var">v1</span> <span class="id" type="var">w1</span>] <span class="id" type="var">H0</span> <span class="id" type="var">H1</span>.<br/>
        <span class="id" type="tactic">rewrite</span> /= <span class="id" type="keyword">in</span> <span class="id" type="var">H0</span>.<br/>
        <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H0</span> /= <span class="id" type="var">H2</span> <span class="id" type="lemma">eq_refl</span> /=.<br/>
        <span class="id" type="tactic">exact</span>: <span class="id" type="var">H3</span>.<br/>
      <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">last_cat</span>.<br/>
      <span class="id" type="tactic">case</span>: <span class="id" type="var">w2</span> <span class="id" type="var">H2</span> <span class="id" type="var">H3</span> =&gt; [|<span class="id" type="var">v2</span> <span class="id" type="var">w2</span>] <span class="id" type="var">H2</span> <span class="id" type="var">H3</span>.<br/>
        <span class="id" type="tactic">rewrite</span> /= <span class="id" type="keyword">in</span> <span class="id" type="var">H2</span>.<br/>
        <span class="id" type="tactic">rewrite</span> -<span class="id" type="var">H2</span> <span class="id" type="var">H0</span> /= <span class="id" type="lemma">eq_refl</span> /=.<br/>
        <span class="id" type="tactic">eapply</span> <a class="idref" href="transitive_closure.html#allbutlast_impl"><span class="id" type="lemma">allbutlast_impl</span></a>.<br/>
        <span class="id" type="tactic">move</span> =&gt; <span class="id" type="var">x</span>. <span class="id" type="tactic">by</span> <span class="id" type="tactic">eapply</span> (@<span class="id" type="lemma">ltnW</span> ((<span class="id" type="definition">enum_rank</span> <span class="id" type="var">x</span>)) <span class="id" type="var">k</span>).<br/>
        <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">cats0</span>.<br/>
        <span class="id" type="tactic">exact</span> <span class="id" type="var">H1</span>.<br/>
<br/>
      <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H0</span> <span class="id" type="var">H2</span> <span class="id" type="lemma">eq_refl</span> <span class="id" type="lemma">andTb</span>.<br/>
      <span class="id" type="tactic">eapply</span> <a class="idref" href="transitive_closure.html#all_allbutlast_cat"><span class="id" type="lemma">all_allbutlast_cat</span></a>.<br/>
        <span class="id" type="tactic">apply</span>: (<a class="idref" href="transitive_closure.html#allbutlast_last"><span class="id" type="lemma">allbutlast_last</span></a> <span class="id" type="var">_</span> <span class="id" type="var">i</span>) =&gt; //.<br/>
          <span class="id" type="tactic">eapply</span> <a class="idref" href="transitive_closure.html#allbutlast_impl"><span class="id" type="lemma">allbutlast_impl</span></a>.<br/>
          <span class="id" type="tactic">move</span> =&gt; <span class="id" type="var">x</span>.<br/>
          <span class="id" type="tactic">by</span> <span class="id" type="tactic">eapply</span> (@<span class="id" type="lemma">ltnW</span> ((<span class="id" type="definition">enum_rank</span> <span class="id" type="var">x</span>)) <span class="id" type="var">k</span>).<br/>
        <span class="id" type="tactic">by</span> [].<br/>
        <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H0</span>.<br/>
        <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">enum_valK</span>.<br/>
        <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span>: <a class="idref" href="transitive_closure.html#k_ord_lt"><span class="id" type="lemma">k_ord_lt</span></a>.<br/>
      <span class="id" type="tactic">by</span> [].<br/>
    <span class="id" type="keyword">Qed</span>.<br/>
<br/>
    <span class="id" type="keyword">Lemma</span> <a name="L_catR"><span class="id" type="lemma">L_catR</span></a> <span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span> <span class="id" type="var">w1</span> <span class="id" type="var">w2</span>:<br/>
      <span class="id" type="var">w1</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span><span class="id" type="notation">.+1</span> <span class="id" type="var">i</span> (<span class="id" type="definition">enum_val</span> (<a class="idref" href="transitive_closure.html#k_ord"><span class="id" type="definition">k_ord</span></a> <span class="id" type="var">k</span>)) -&gt;<br/>
      <span class="id" type="var">w2</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span> (<span class="id" type="definition">enum_val</span> (<a class="idref" href="transitive_closure.html#k_ord"><span class="id" type="definition">k_ord</span></a> <span class="id" type="var">k</span>)) <span class="id" type="var">j</span> -&gt;<br/>
      <span class="id" type="var">w1</span><span class="id" type="notation">++</span><span class="id" type="var">w2</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span><span class="id" type="notation">.+1</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span>.<br/>
    <span class="id" type="keyword">Proof</span>.<br/>
      <span class="id" type="tactic">rewrite</span> /<a class="idref" href="transitive_closure.html#L"><span class="id" type="definition">L</span></a> -3!<span class="id" type="lemma">topredE</span> /=.<br/>
      <span class="id" type="tactic">rewrite</span> <a class="idref" href="automata.html#dfa_run'_cat"><span class="id" type="lemma">dfa_run'_cat</span></a>.<br/>
      <span class="id" type="tactic">move</span> =&gt; /<span class="id" type="lemma">andP</span> [] /<span class="id" type="lemma">eqP</span> <span class="id" type="var">H0</span> <span class="id" type="var">H1</span> /<span class="id" type="lemma">andP</span> [] /<span class="id" type="lemma">eqP</span> <span class="id" type="var">H2</span> <span class="id" type="var">H3</span>.<br/>
      <span class="id" type="tactic">case</span>: <span class="id" type="var">w1</span> <span class="id" type="var">H0</span> <span class="id" type="var">H1</span> =&gt; [|<span class="id" type="var">v1</span> <span class="id" type="var">w1</span>] <span class="id" type="var">H0</span> <span class="id" type="var">H1</span>.<br/>
        <span class="id" type="tactic">rewrite</span> /= <span class="id" type="keyword">in</span> <span class="id" type="var">H0</span>.<br/>
        <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H0</span> /= <span class="id" type="var">H2</span> <span class="id" type="lemma">eq_refl</span> /=.<br/>
        <span class="id" type="tactic">eapply</span> <a class="idref" href="transitive_closure.html#allbutlast_impl"><span class="id" type="lemma">allbutlast_impl</span></a>.<br/>
        <span class="id" type="tactic">move</span> =&gt; <span class="id" type="var">x</span>. <span class="id" type="tactic">by</span> <span class="id" type="tactic">eapply</span> (@<span class="id" type="lemma">ltnW</span> ((<span class="id" type="definition">enum_rank</span> <span class="id" type="var">x</span>)) <span class="id" type="var">k</span>).<br/>
        <span class="id" type="tactic">exact</span>: <span class="id" type="var">H3</span>.<br/>
      <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">last_cat</span>.<br/>
      <span class="id" type="tactic">case</span>: <span class="id" type="var">w2</span> <span class="id" type="var">H2</span> <span class="id" type="var">H3</span> =&gt; [|<span class="id" type="var">v2</span> <span class="id" type="var">w2</span>] <span class="id" type="var">H2</span> <span class="id" type="var">H3</span>.<br/>
        <span class="id" type="tactic">rewrite</span> /= <span class="id" type="keyword">in</span> <span class="id" type="var">H2</span>.<br/>
        <span class="id" type="tactic">rewrite</span> -<span class="id" type="var">H2</span> <span class="id" type="var">H0</span> /= <span class="id" type="lemma">eq_refl</span> /=.<br/>
        <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">cats0</span>.<br/>
        <span class="id" type="tactic">exact</span> <span class="id" type="var">H1</span>.<br/>
<br/>
      <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H0</span> <span class="id" type="var">H2</span> <span class="id" type="lemma">eq_refl</span> <span class="id" type="lemma">andTb</span>.<br/>
      <span class="id" type="tactic">eapply</span> <a class="idref" href="transitive_closure.html#all_allbutlast_cat"><span class="id" type="lemma">all_allbutlast_cat</span></a>.<br/>
        <span class="id" type="tactic">apply</span>: (<a class="idref" href="transitive_closure.html#allbutlast_last"><span class="id" type="lemma">allbutlast_last</span></a> <span class="id" type="var">_</span> <span class="id" type="var">i</span>) =&gt; //.<br/>
        <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H0</span>.<br/>
        <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">enum_valK</span>.<br/>
        <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span>: <a class="idref" href="transitive_closure.html#k_ord_lt"><span class="id" type="lemma">k_ord_lt</span></a>.<br/>
        <span class="id" type="tactic">eapply</span> <a class="idref" href="transitive_closure.html#allbutlast_impl"><span class="id" type="lemma">allbutlast_impl</span></a>.<br/>
          <span class="id" type="tactic">move</span> =&gt; <span class="id" type="var">x</span>.<br/>
        <span class="id" type="tactic">by</span> <span class="id" type="tactic">eapply</span> (@<span class="id" type="lemma">ltnW</span> ((<span class="id" type="definition">enum_rank</span> <span class="id" type="var">x</span>)) <span class="id" type="var">k</span>).<br/>
      <span class="id" type="tactic">by</span> [].<br/>
    <span class="id" type="keyword">Qed</span>.<br/>
  <span class="id" type="keyword">End</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.L"><span class="id" type="section">L</span></a>.<br/>
<br/>
  <span class="id" type="keyword">Section</span> <a name="TransitiveClosure.R"><span class="id" type="section">R</span></a>.<br/>
<br/>
    <span class="id" type="keyword">Lemma</span> <a name="Conc_assoc"><span class="id" type="lemma">Conc_assoc</span></a> <span class="id" type="var">r</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span> (<span class="id" type="var">w</span>: <span class="id" type="definition">word</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.char"><span class="id" type="variable">char</span></a>): <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><span class="id" type="var">w</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <span class="id" type="constructor">Conc</span> <span class="id" type="var">r</span> (<span class="id" type="constructor">Conc</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span>)<a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><span class="id" type="var">w</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <span class="id" type="constructor">Conc</span> (<span class="id" type="constructor">Conc</span> <span class="id" type="var">r</span> <span class="id" type="var">s</span>) <span class="id" type="var">t</span><a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a>.<br/>
    <span class="id" type="keyword">Proof</span>.<br/>
      <span class="id" type="tactic">rewrite</span> -<span class="id" type="lemma">topredE</span> -<span class="id" type="lemma">topredE</span> /=.<br/>
      <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">concP</span>/<span class="id" type="lemma">concP</span>.<br/>
        <span class="id" type="tactic">move</span> =&gt; [] <span class="id" type="var">v1</span> <span class="id" type="var">Hr</span> [] <span class="id" type="var">v23</span> /<span class="id" type="lemma">concP</span> [] <span class="id" type="var">v2</span> <span class="id" type="var">Hs</span> [] <span class="id" type="var">v3</span> <span class="id" type="var">Ht</span> <span class="id" type="var">H0</span> <span class="id" type="var">H1</span>.<br/>
        <span class="id" type="var">exists</span> (<span class="id" type="var">v1</span><span class="id" type="notation">++</span><span class="id" type="var">v2</span>).<br/>
        <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">concP</span>.<br/>
        <span class="id" type="var">exists</span> <span class="id" type="var">v1</span> =&gt; //.<br/>
          <span class="id" type="tactic">by</span> <span class="id" type="var">exists</span> <span class="id" type="var">v2</span>.<br/>
        <span class="id" type="var">exists</span> <span class="id" type="var">v3</span> =&gt; //.<br/>
        <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -<span class="id" type="lemma">catA</span> <span class="id" type="var">H1</span> <span class="id" type="var">H0</span>.<br/>
<br/>
      <span class="id" type="tactic">move</span> =&gt; [] <span class="id" type="var">v12</span> /<span class="id" type="lemma">concP</span> [] <span class="id" type="var">v1</span> <span class="id" type="var">Hr</span> [] <span class="id" type="var">v2</span> <span class="id" type="var">Hs</span> <span class="id" type="var">H0</span> [] <span class="id" type="var">v3</span> <span class="id" type="var">Ht</span> <span class="id" type="var">H1</span>.<br/>
      <span class="id" type="var">exists</span> <span class="id" type="var">v1</span> =&gt; //.<br/>
      <span class="id" type="var">exists</span> (<span class="id" type="var">v2</span> <span class="id" type="notation">++</span> <span class="id" type="var">v3</span>).<br/>
        <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">concP</span>.<br/>
        <span class="id" type="var">exists</span> <span class="id" type="var">v2</span> =&gt; //.<br/>
        <span class="id" type="var">exists</span> <span class="id" type="var">v3</span> =&gt; //.<br/>
      <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H1</span> <span class="id" type="lemma">catA</span> <span class="id" type="var">H0</span>.<br/>
    <span class="id" type="keyword">Qed</span>.<br/>
<br/>
    <span class="id" type="keyword">Lemma</span> <a name="Conc_Star_idem"><span class="id" type="lemma">Conc_Star_idem</span></a> <span class="id" type="var">r</span> (<span class="id" type="var">w</span>: <span class="id" type="definition">word</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.char"><span class="id" type="variable">char</span></a>): <span class="id" type="var">w</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <span class="id" type="constructor">Conc</span> <span class="id" type="var">r</span> (<span class="id" type="constructor">Star</span> <span class="id" type="var">r</span>) -&gt; (<span class="id" type="var">w</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <span class="id" type="constructor">Star</span> <span class="id" type="var">r</span>).<br/>
    <span class="id" type="keyword">Proof</span>.<br/>
      <span class="id" type="tactic">rewrite</span> -<span class="id" type="lemma">topredE</span> -<span class="id" type="lemma">topredE</span> /=.<br/>
      <span class="id" type="tactic">move</span>/<span class="id" type="lemma">concP</span>.<br/>
      <span class="id" type="tactic">move</span> =&gt; [] <span class="id" type="var">v1</span> <span class="id" type="var">H1</span> [] <span class="id" type="var">v2</span> /<span class="id" type="lemma">starP</span> [] <span class="id" type="var">vv</span> <span class="id" type="var">H2</span> <span class="id" type="var">H3</span> <span class="id" type="var">H4</span>.<br/>
      <span class="id" type="tactic">case</span>: <span class="id" type="var">v1</span> <span class="id" type="var">H1</span> <span class="id" type="var">H4</span> =&gt; [|<span class="id" type="var">v</span> <span class="id" type="var">v1</span>] <span class="id" type="var">H1</span> <span class="id" type="var">H4</span>.<br/>
        <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">starP</span>.<br/>
        <span class="id" type="var">exists</span> <span class="id" type="var">vv</span> =&gt; //.<br/>
        <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H4</span> <span class="id" type="var">H3</span>.<br/>
      <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">starP</span>.<br/>
      <span class="id" type="var">exists</span> (<span class="id" type="notation">[::(</span><span class="id" type="var">v</span><span class="id" type="notation">::</span><span class="id" type="var">v1</span><span class="id" type="notation">)]</span><span class="id" type="notation">++</span><span class="id" type="var">vv</span>).<br/>
        <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> /= <span class="id" type="var">H2</span> <span class="id" type="lemma">andbT</span> <span class="id" type="var">H1</span>.<br/>
      <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H4</span> <span class="id" type="var">H3</span>.<br/>
    <span class="id" type="keyword">Qed</span>.<br/>
<br/>
    <span class="id" type="keyword">Lemma</span> <a name="R_catL"><span class="id" type="lemma">R_catL</span></a> <span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span> <span class="id" type="var">w1</span> <span class="id" type="var">w2</span>:<br/>
      <span class="id" type="var">w1</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'R^'_x"><span class="id" type="notation">R</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'R^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span> <span class="id" type="var">i</span>  (<a class="idref" href="transitive_closure.html#k_ord"><span class="id" type="definition">k_ord</span></a> <span class="id" type="var">k</span>) -&gt;<br/>
      <span class="id" type="var">w2</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'R^'_x"><span class="id" type="notation">R</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'R^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span><span class="id" type="notation">.+1</span> (<a class="idref" href="transitive_closure.html#k_ord"><span class="id" type="definition">k_ord</span></a> <span class="id" type="var">k</span>) <span class="id" type="var">j</span> -&gt;<br/>
      <span class="id" type="var">w1</span><span class="id" type="notation">++</span><span class="id" type="var">w2</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'R^'_x"><span class="id" type="notation">R</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'R^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span><span class="id" type="notation">.+1</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span>.<br/>
    <span class="id" type="keyword">Proof</span>.<br/>
      <span class="id" type="tactic">rewrite</span> /=.<br/>
      <span class="id" type="tactic">move</span> =&gt; <span class="id" type="var">H0</span>.<br/>
      <span class="id" type="tactic">rewrite</span> <a class="idref" href="transitive_closure.html#Plus_dist"><span class="id" type="lemma">Plus_dist</span></a> =&gt; /<span class="id" type="lemma">orP</span> [].<br/>
        <span class="id" type="tactic">rewrite</span> <a class="idref" href="transitive_closure.html#Conc_assoc"><span class="id" type="lemma">Conc_assoc</span></a>.<br/>
        <span class="id" type="tactic">rewrite</span> -<span class="id" type="lemma">topredE</span> /=.<br/>
        <span class="id" type="tactic">move</span>/<span class="id" type="lemma">concP</span> =&gt; [] <span class="id" type="var">v1</span>.<br/>
        <span class="id" type="tactic">move</span>/<a class="idref" href="transitive_closure.html#Conc_Star_idem"><span class="id" type="lemma">Conc_Star_idem</span></a> =&gt; <span class="id" type="var">H1</span> [] <span class="id" type="var">v2</span> <span class="id" type="var">H2</span> <span class="id" type="var">H3</span>.<br/>
        <span class="id" type="tactic">rewrite</span> <a class="idref" href="transitive_closure.html#Plus_dist"><span class="id" type="lemma">Plus_dist</span></a>.<br/>
        <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">orP</span>. <span class="id" type="var">left</span>.<br/>
        <span class="id" type="tactic">rewrite</span> -<span class="id" type="lemma">topredE</span> /=.<br/>
        <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">concP</span>.<br/>
        <span class="id" type="var">exists</span> <span class="id" type="var">w1</span> =&gt; //.<br/>
        <span class="id" type="var">exists</span> <span class="id" type="var">w2</span> =&gt; //.<br/>
        <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">concP</span>.<br/>
        <span class="id" type="var">exists</span> (<span class="id" type="var">v1</span>) =&gt; //.<br/>
        <span class="id" type="var">exists</span> (<span class="id" type="var">v2</span>) =&gt; //.<br/>
<br/>
      <span class="id" type="tactic">rewrite</span> <a class="idref" href="transitive_closure.html#Plus_dist"><span class="id" type="lemma">Plus_dist</span></a>.<br/>
      <span class="id" type="tactic">move</span> =&gt; <span class="id" type="var">H1</span>.<br/>
      <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">orP</span>. <span class="id" type="var">left</span>.<br/>
      <span class="id" type="tactic">rewrite</span> -<span class="id" type="lemma">topredE</span> /=.<br/>
      <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">concP</span>.<br/>
      <span class="id" type="var">exists</span> <span class="id" type="var">w1</span> =&gt; //.<br/>
      <span class="id" type="var">exists</span> <span class="id" type="var">w2</span> =&gt; //.<br/>
      <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">concP</span>.<br/>
      <span class="id" type="var">exists</span> <span class="id" type="notation">[::]</span> =&gt; //.<br/>
      <span class="id" type="var">exists</span> <span class="id" type="var">w2</span> =&gt; //.<br/>
    <span class="id" type="keyword">Qed</span>.<br/>
<br/>
    <span class="id" type="keyword">Lemma</span> <a name="R_nil"><span class="id" type="lemma">R_nil</span></a> <span class="id" type="var">k</span> <span class="id" type="var">i</span>: <span class="id" type="notation">[::]</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'R^'_x"><span class="id" type="notation">R</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'R^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">i</span>.<br/>
    <span class="id" type="keyword">Proof</span>.<br/>
      <span class="id" type="tactic">elim</span>: <span class="id" type="var">k</span> <span class="id" type="var">i</span> =&gt; [|<span class="id" type="var">k</span> <span class="id" type="var">IHk</span>] <span class="id" type="var">i</span>.<br/>
        <span class="id" type="tactic">rewrite</span> /= <span class="id" type="lemma">eq_refl</span> /= <a class="idref" href="transitive_closure.html#Plus_dist"><span class="id" type="lemma">Plus_dist</span></a> -<span class="id" type="lemma">topredE</span> /=.<br/>
        <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">orP</span>. <span class="id" type="tactic">by</span> <span class="id" type="var">right</span>.<br/>
      <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> /= <a class="idref" href="transitive_closure.html#Plus_dist"><span class="id" type="lemma">Plus_dist</span></a> <span class="id" type="var">IHk</span> <span class="id" type="lemma">orbT</span>.<br/>
    <span class="id" type="keyword">Qed</span>.<br/>
<br/>
  <span class="id" type="keyword">End</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.R"><span class="id" type="section">R</span></a>.<br/>
<br/>
  <span class="id" type="keyword">Lemma</span> <a name="R_L_star"><span class="id" type="lemma">R_L_star</span></a> <span class="id" type="var">k</span> <span class="id" type="var">vv</span>:<br/>
    (<span class="id" type="keyword">forall</span> (<span class="id" type="var">i</span> <span class="id" type="var">j</span> : <span class="id" type="notation">'</span><span class="id" type="notation">I_</span><span class="id" type="notation">#|</span><a class="idref" href="transitive_closure.html#TransitiveClosure.A"><span class="id" type="variable">A</span></a><span class="id" type="notation">|</span>) (<span class="id" type="var">w</span> : <span class="id" type="definition">word</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.char"><span class="id" type="variable">char</span></a>),<br/>
        <span class="id" type="var">w</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'R^'_x"><span class="id" type="notation">R</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'R^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span> -&gt; <span class="id" type="var">w</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span> (<span class="id" type="definition">enum_val</span> <span class="id" type="var">i</span>) (<span class="id" type="definition">enum_val</span> <span class="id" type="var">j</span>)) -&gt;<br/>
     <span class="id" type="definition">all</span> <span class="id" type="notation">[</span><span class="id" type="notation">predD</span> <span class="id" type="definition">mem_reg</span> (<a class="idref" href="transitive_closure.html#TransitiveClosure.::'R^'_x"><span class="id" type="notation">R</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'R^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span> (<a class="idref" href="transitive_closure.html#k_ord"><span class="id" type="definition">k_ord</span></a> <span class="id" type="var">k</span>) (<a class="idref" href="transitive_closure.html#k_ord"><span class="id" type="definition">k_ord</span></a> <span class="id" type="var">k</span>)) <span class="id" type="notation">&amp;</span> <br/>
          <span class="id" type="definition">eps</span> (<span class="id" type="var">symbol</span>:=<a class="idref" href="transitive_closure.html#TransitiveClosure.char"><span class="id" type="variable">char</span></a>)<span class="id" type="notation">]</span> <span class="id" type="var">vv</span> -&gt;<br/>
     <span class="id" type="definition">flatten</span> <span class="id" type="var">vv</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span><span class="id" type="notation">.+1</span> (<span class="id" type="definition">enum_val</span> (<a class="idref" href="transitive_closure.html#k_ord"><span class="id" type="definition">k_ord</span></a> <span class="id" type="var">k</span>)) (<span class="id" type="definition">enum_val</span> (<a class="idref" href="transitive_closure.html#k_ord"><span class="id" type="definition">k_ord</span></a> <span class="id" type="var">k</span>)).<br/>
  <span class="id" type="keyword">Proof</span>.<br/>
    <span class="id" type="tactic">move</span> =&gt; <span class="id" type="var">IHk</span>.<br/>
    <span class="id" type="tactic">elim</span>: <span class="id" type="var">vv</span> =&gt; [|<span class="id" type="var">v</span> <span class="id" type="var">vv</span> <span class="id" type="var">IHvv</span>].<br/>
      <span class="id" type="tactic">move</span> =&gt; <span class="id" type="var">H0</span>. <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span>: <a class="idref" href="transitive_closure.html#L_nil"><span class="id" type="lemma">L_nil</span></a>.<br/>
    <span class="id" type="tactic">rewrite</span> /= =&gt; /<span class="id" type="lemma">andP</span> [] /<span class="id" type="lemma">andP</span> [].<br/>
    <span class="id" type="tactic">rewrite</span> -<span class="id" type="lemma">topredE</span> /= /<span class="id" type="definition">eps</span> /= =&gt; <span class="id" type="var">H0</span>.<br/>
    <span class="id" type="tactic">move</span> =&gt; <span class="id" type="var">H1</span>.<br/>
    <span class="id" type="tactic">move</span>/<span class="id" type="var">IHvv</span>.<br/>
    <span class="id" type="tactic">apply</span>: <a class="idref" href="transitive_closure.html#L_catL"><span class="id" type="lemma">L_catL</span></a>.<br/>
    <span class="id" type="tactic">apply</span>: <span class="id" type="var">IHk</span>.<br/>
    <span class="id" type="tactic">by</span> [].<br/>
  <span class="id" type="keyword">Qed</span>.<br/>
<br/>
  <span class="id" type="keyword">Lemma</span> <a name="R_L"><span class="id" type="lemma">R_L</span></a> <span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span> <span class="id" type="var">w</span>: <span class="id" type="var">w</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'R^'_x"><span class="id" type="notation">R</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'R^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span> -&gt; <span class="id" type="var">w</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span> (<span class="id" type="definition">enum_val</span> <span class="id" type="var">i</span>) (<span class="id" type="definition">enum_val</span> <span class="id" type="var">j</span>).<br/>
  <span class="id" type="keyword">Proof</span>.<br/>
    <span class="id" type="tactic">elim</span>: <span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span> <span class="id" type="var">w</span> =&gt; [|<span class="id" type="var">k</span> <span class="id" type="var">IHk</span>] <span class="id" type="var">i</span> <span class="id" type="var">j</span> <span class="id" type="var">w</span>.<br/>
<br/>
      <span class="id" type="var">case_eq</span> (<span class="id" type="var">i</span><span class="id" type="notation">==</span><span class="id" type="var">j</span>) =&gt; <span class="id" type="var">H0</span> /=.<br/>
        <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H0</span> /=.<br/>
        <span class="id" type="tactic">rewrite</span> <a class="idref" href="transitive_closure.html#Plus_dist"><span class="id" type="lemma">Plus_dist</span></a> =&gt; /<span class="id" type="lemma">orP</span> [].<br/>
          <span class="id" type="tactic">rewrite</span> <a class="idref" href="transitive_closure.html#foldr_Plus"><span class="id" type="lemma">foldr_Plus</span></a> =&gt; /<span class="id" type="lemma">orP</span> [] //.<br/>
          <span class="id" type="tactic">move</span>/<span class="id" type="lemma">hasP</span> =&gt; [] <span class="id" type="var">r</span> /<span class="id" type="lemma">mapP</span> [] <span class="id" type="var">a</span>.<br/>
          <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">mem_filter</span> /= =&gt; /<span class="id" type="lemma">andP</span> [] <span class="id" type="var">H1</span> <span class="id" type="var">_</span> -&gt;.<br/>
          <span class="id" type="tactic">rewrite</span> -<span class="id" type="lemma">topredE</span> /= /<span class="id" type="definition">atom</span> /= =&gt; /<span class="id" type="lemma">eqP</span> -&gt;.<br/>
          <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -<span class="id" type="lemma">topredE</span> /= /<a class="idref" href="transitive_closure.html#L"><span class="id" type="definition">L</span></a> /= <span class="id" type="var">H1</span>.<br/>
        <span class="id" type="tactic">rewrite</span> -<span class="id" type="lemma">topredE</span> /= /<span class="id" type="definition">eps</span> /= =&gt; /<span class="id" type="lemma">eqP</span> -&gt;.<br/>
        <span class="id" type="tactic">move</span>/<span class="id" type="lemma">eqP</span>: <span class="id" type="var">H0</span> =&gt; -&gt;.<br/>
        <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span>: <a class="idref" href="transitive_closure.html#L_nil"><span class="id" type="lemma">L_nil</span></a>.<br/>
      <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H0</span>.<br/>
      <span class="id" type="tactic">rewrite</span> <a class="idref" href="transitive_closure.html#foldr_Plus"><span class="id" type="lemma">foldr_Plus</span></a> =&gt; /<span class="id" type="lemma">orP</span> [] //.<br/>
      <span class="id" type="tactic">move</span>/<span class="id" type="lemma">hasP</span> =&gt; [] <span class="id" type="var">r</span> /<span class="id" type="lemma">mapP</span> [] <span class="id" type="var">a</span>.<br/>
      <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">mem_filter</span> /= =&gt; /<span class="id" type="lemma">andP</span> [] <span class="id" type="var">H1</span> <span class="id" type="var">_</span> -&gt;.<br/>
      <span class="id" type="tactic">rewrite</span> -<span class="id" type="lemma">topredE</span> /= /<span class="id" type="definition">atom</span> /= =&gt; /<span class="id" type="lemma">eqP</span> -&gt;.<br/>
      <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -<span class="id" type="lemma">topredE</span> /= /<a class="idref" href="transitive_closure.html#L"><span class="id" type="definition">L</span></a> /= <span class="id" type="var">H1</span>.<br/>
<br/>
<br/>
    <span class="id" type="tactic">rewrite</span> /= <a class="idref" href="transitive_closure.html#Plus_dist"><span class="id" type="lemma">Plus_dist</span></a> =&gt; /<span class="id" type="lemma">orP</span> [].<br/>
      <span class="id" type="tactic">rewrite</span> -<span class="id" type="lemma">topredE</span> /= =&gt; /<span class="id" type="lemma">concP</span> [] <span class="id" type="var">w1</span> /<span class="id" type="var">IHk</span> <span class="id" type="var">H1</span> [] <span class="id" type="var">w23</span>.<br/>
      <span class="id" type="tactic">move</span> =&gt; /<span class="id" type="lemma">concP</span> [] <span class="id" type="var">w2</span> <span class="id" type="var">H2</span> [] <span class="id" type="var">w3</span> /<span class="id" type="var">IHk</span> <span class="id" type="var">H3</span>.<br/>
      <span class="id" type="tactic">move</span> =&gt; <span class="id" type="var">Eq1</span> <span class="id" type="var">Eq2</span>.<br/>
      <span class="id" type="tactic">move</span>/<span class="id" type="lemma">starP</span>: <span class="id" type="var">H2</span> =&gt; [] <span class="id" type="var">vv</span> <span class="id" type="var">Hvv</span> <span class="id" type="var">Eqvv</span>.<br/>
      <span class="id" type="var">pose</span> <span class="id" type="var">k'</span> := <span class="id" type="definition">enum_val</span> (<a class="idref" href="transitive_closure.html#k_ord"><span class="id" type="definition">k_ord</span></a> <span class="id" type="var">k</span>).<br/>
      <span class="id" type="tactic">assert</span> (<span class="id" type="var">w2</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span><span class="id" type="notation">.+1</span> <span class="id" type="var">k'</span> <span class="id" type="var">k'</span>).<br/>
        <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Eqvv</span>.<br/>
        <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span>: <a class="idref" href="transitive_closure.html#R_L_star"><span class="id" type="lemma">R_L_star</span></a>.<br/>
      <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Eq2</span>.<br/>
      <span class="id" type="tactic">apply</span>: <a class="idref" href="transitive_closure.html#L_catL"><span class="id" type="lemma">L_catL</span></a> =&gt; //.<br/>
      <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Eq1</span>.<br/>
      <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span>: <a class="idref" href="transitive_closure.html#L_catR"><span class="id" type="lemma">L_catR</span></a>.<br/>
    <span class="id" type="tactic">move</span>/<span class="id" type="var">IHk</span>.<br/>
    <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span>: <a class="idref" href="transitive_closure.html#L_monotone"><span class="id" type="lemma">L_monotone</span></a>.<br/>
  <span class="id" type="keyword">Qed</span>.<br/>
<br/>
  <span class="id" type="keyword">Lemma</span> <a name="size_induction"><span class="id" type="lemma">size_induction</span></a> (<span class="id" type="var">X</span> : <span class="id" type="keyword">Type</span>) (<span class="id" type="var">f</span> : <span class="id" type="var">X</span> -&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>) (<span class="id" type="var">p</span>: <span class="id" type="var">X</span> -&gt;<span class="id" type="keyword">Prop</span>) :<br/>
  ( <span class="id" type="keyword">forall</span> <span class="id" type="var">x</span>, ( <span class="id" type="keyword">forall</span> <span class="id" type="var">y</span>, <span class="id" type="var">f</span> <span class="id" type="var">y</span> <span class="id" type="notation">&lt;</span> <span class="id" type="var">f</span> <span class="id" type="var">x</span> -&gt; <span class="id" type="var">p</span> <span class="id" type="var">y</span>) -&gt; <span class="id" type="var">p</span> <span class="id" type="var">x</span>) -&gt; <span class="id" type="keyword">forall</span> <span class="id" type="var">x</span>, <span class="id" type="var">p</span> <span class="id" type="var">x</span>.<br/>
  <span class="id" type="var">Admitted</span>.<br/>
<br/>
  <span class="id" type="keyword">Lemma</span> <a name="L_R_1"><span class="id" type="lemma">L_R_1</span></a> <span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span> <span class="id" type="var">w</span>:<br/>
       (<span class="id" type="keyword">forall</span> (<span class="id" type="var">i</span> <span class="id" type="var">j</span> : <span class="id" type="notation">'</span><span class="id" type="notation">I_</span><span class="id" type="notation">#|</span><a class="idref" href="transitive_closure.html#TransitiveClosure.A"><span class="id" type="variable">A</span></a><span class="id" type="notation">|</span>) (<span class="id" type="var">w</span> : <a class="idref" href="automata.html#word"><span class="id" type="definition">automata.word</span></a> <a class="idref" href="transitive_closure.html#TransitiveClosure.char"><span class="id" type="variable">char</span></a>),<br/>
        <span class="id" type="var">w</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span> (<span class="id" type="definition">enum_val</span> <span class="id" type="var">i</span>) (<span class="id" type="definition">enum_val</span> <span class="id" type="var">j</span>) -&gt; <span class="id" type="var">w</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'R^'_x"><span class="id" type="notation">R</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'R^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span>) -&gt;<br/>
        <span class="id" type="var">w</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span><span class="id" type="notation">.+1</span> (<span class="id" type="definition">enum_val</span> <span class="id" type="var">i</span>) (<span class="id" type="definition">enum_val</span> <span class="id" type="var">j</span>) -&gt; <span class="id" type="var">w</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'R^'_x"><span class="id" type="notation">R</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'R^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span><span class="id" type="notation">.+1</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span>.<br/>
  <span class="id" type="keyword">Proof</span>.<br/>
    <span class="id" type="tactic">move</span> =&gt; <span class="id" type="var">IHk</span>.<br/>
    <span class="id" type="tactic">move</span>: <span class="id" type="var">w</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span>.<br/>
    <span class="id" type="tactic">apply</span>: (<a class="idref" href="transitive_closure.html#size_induction"><span class="id" type="axiom">size_induction</span></a> (<span class="id" type="definition">size</span>)) =&gt; <span class="id" type="var">w</span> <span class="id" type="var">IHw</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span>.<br/>
    <span class="id" type="tactic">case</span>: <span class="id" type="var">w</span> <span class="id" type="var">IHw</span> =&gt; [|<span class="id" type="var">a</span> <span class="id" type="var">w</span>] <span class="id" type="var">IHw</span>.<br/>
      <span class="id" type="tactic">move</span>/<a class="idref" href="transitive_closure.html#L_nil'"><span class="id" type="lemma">L_nil'</span></a>/(<a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Logic.html#f_equal"><span class="id" type="lemma">f_equal</span></a> <span class="id" type="definition">enum_rank</span>).<br/>
      <span class="id" type="tactic">rewrite</span> 2!<span class="id" type="lemma">enum_valK</span> =&gt; -&gt;.<br/>
      <span class="id" type="tactic">exact</span>: <a class="idref" href="transitive_closure.html#R_nil"><span class="id" type="lemma">R_nil</span></a>.<br/>
    <span class="id" type="tactic">move</span>/<a class="idref" href="transitive_closure.html#L_split"><span class="id" type="lemma">L_split</span></a> =&gt; [].<br/>
      <span class="id" type="tactic">move</span>/<span class="id" type="var">IHk</span>.<br/>
      <span class="id" type="tactic">rewrite</span> /= <a class="idref" href="transitive_closure.html#Plus_dist"><span class="id" type="lemma">Plus_dist</span></a> =&gt; -&gt;.<br/>
      <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">orbT</span>.<br/>
    <span class="id" type="tactic">move</span> =&gt; [] <span class="id" type="var">w1</span> [] <span class="id" type="var">w2</span> [] <span class="id" type="var">H0</span> [] <span class="id" type="var">H1</span> [] <span class="id" type="var">H2</span> <span class="id" type="var">H3</span>.<br/>
    <span class="id" type="tactic">assert</span> (<span class="id" type="definition">size</span> <span class="id" type="var">w1</span> <span class="id" type="notation">&gt;</span> 0).<br/>
      <span class="id" type="tactic">case</span>: <span class="id" type="var">w1</span> <span class="id" type="var">H0</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span> =&gt; [|<span class="id" type="var">b</span> <span class="id" type="var">w1</span>] <span class="id" type="var">H0</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span> =&gt; //.<br/>
    <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H0</span>.<br/>
    <span class="id" type="tactic">apply</span>: <a class="idref" href="transitive_closure.html#R_catL"><span class="id" type="lemma">R_catL</span></a>.<br/>
      <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span>: <span class="id" type="var">IHk</span>.<br/>
    <span class="id" type="tactic">apply</span>: <span class="id" type="var">IHw</span> =&gt; //.<br/>
    <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H0</span> <span class="id" type="lemma">size_cat</span>.<br/>
    <span class="id" type="tactic">rewrite</span> -{1}(<span class="id" type="lemma">addn0</span> (<span class="id" type="definition">size</span> <span class="id" type="var">w2</span>)).<br/>
    <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">addnC</span>.<br/>
    <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">ltn_add2r</span>.<br/>
  <span class="id" type="keyword">Qed</span>.<br/>
<br/>
  <span class="id" type="keyword">Lemma</span> <a name="L_R"><span class="id" type="lemma">L_R</span></a> <span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span> <span class="id" type="var">w</span>: <span class="id" type="var">w</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">L</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'L^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span> (<span class="id" type="definition">enum_val</span> <span class="id" type="var">i</span>) (<span class="id" type="definition">enum_val</span> <span class="id" type="var">j</span>) -&gt; <span class="id" type="var">w</span> <span class="id" type="notation">\</span><span class="id" type="keyword">in</span> <a class="idref" href="transitive_closure.html#TransitiveClosure.::'R^'_x"><span class="id" type="notation">R</span></a><a class="idref" href="transitive_closure.html#TransitiveClosure.::'R^'_x"><span class="id" type="notation">^</span></a><span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span>.<br/>
  <span class="id" type="keyword">Proof</span>.<br/>
    <span class="id" type="tactic">elim</span>: <span class="id" type="var">k</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span> <span class="id" type="var">w</span> =&gt; [|<span class="id" type="var">k</span> <span class="id" type="var">IHk</span>] <span class="id" type="var">i</span> <span class="id" type="var">j</span> <span class="id" type="var">w</span>.<br/>
      <span class="id" type="tactic">assert</span> (<span class="id" type="notation">(</span><span class="id" type="keyword">fun</span> <span class="id" type="var">x</span>:<a class="idref" href="transitive_closure.html#TransitiveClosure.A"><span class="id" type="variable">A</span></a> =&gt; <span class="id" type="definition">enum_rank</span> <span class="id" type="var">x</span> <span class="id" type="notation">&lt;</span> 0<span class="id" type="notation">)</span> <span class="id" type="notation">=1</span> <span class="id" type="definition">pred0</span>) =&gt; //.<br/>
      <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">in_simpl</span> =&gt; /<span class="id" type="lemma">andP</span> [] <span class="id" type="var">H0</span> /(<a class="idref" href="transitive_closure.html#allbutlast_pred0"><span class="id" type="lemma">allbutlast_pred0</span></a> <span class="id" type="var">_</span> <span class="id" type="var">H</span>).<br/>
      <span class="id" type="tactic">move</span>: <span class="id" type="var">H0</span>. <span class="id" type="tactic">case</span>: <span class="id" type="var">w</span> =&gt; [|<span class="id" type="var">a</span> [|<span class="id" type="var">b</span> <span class="id" type="var">w</span>]] <span class="id" type="var">H0</span> <span class="id" type="var">_</span> //.<br/>
        <span class="id" type="tactic">move</span>/<span class="id" type="lemma">eqP</span>/(<a class="idref" href="http://coq.inria.fr/distrib/8.3pl4/stdlib/Coq.Init.Logic.html#f_equal"><span class="id" type="lemma">f_equal</span></a> <span class="id" type="definition">enum_rank</span>) <span class="id" type="keyword">in</span> <span class="id" type="var">H0</span>.<br/>
        <span class="id" type="tactic">rewrite</span> 2!<span class="id" type="lemma">enum_valK</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H0</span>.<br/>
        <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H0</span>.<br/>
        <span class="id" type="tactic">exact</span>: <a class="idref" href="transitive_closure.html#R_nil"><span class="id" type="lemma">R_nil</span></a>.<br/>
      <span class="id" type="var">case_eq</span> (<span class="id" type="var">i</span><span class="id" type="notation">==</span><span class="id" type="var">j</span>) =&gt; <span class="id" type="var">H1</span>.<br/>
        <span class="id" type="tactic">move</span>/<span class="id" type="lemma">eqP</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H1</span>.<br/>
        <span class="id" type="tactic">rewrite</span> /= <span class="id" type="var">H1</span> <span class="id" type="lemma">eq_refl</span> /=.<br/>
        <span class="id" type="tactic">rewrite</span> <a class="idref" href="transitive_closure.html#Plus_dist"><span class="id" type="lemma">Plus_dist</span></a> <a class="idref" href="transitive_closure.html#foldr_Plus"><span class="id" type="lemma">foldr_Plus</span></a> 2!<span class="id" type="lemma">in_simpl</span> <span class="id" type="lemma">orbF</span> /=.<br/>
        <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">hasP</span>. <span class="id" type="var">exists</span> (<span class="id" type="constructor">Atom</span> <span class="id" type="var">a</span>).<br/>
          <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">mapP</span>. <span class="id" type="var">exists</span> <span class="id" type="var">a</span> =&gt; //.<br/>
          <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">mem_filter</span>.<br/>
          <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H1</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H0</span>.<br/>
          <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">mem_enum</span> <span class="id" type="lemma">andbT</span> /= <span class="id" type="var">H0</span>.<br/>
        <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">in_simpl</span> /= <span class="id" type="lemma">eq_refl</span>.<br/>
      <span class="id" type="tactic">rewrite</span> /= <span class="id" type="var">H1</span>.<br/>
      <span class="id" type="tactic">rewrite</span> <a class="idref" href="transitive_closure.html#foldr_Plus"><span class="id" type="lemma">foldr_Plus</span></a> <span class="id" type="lemma">orFb</span>.<br/>
      <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">hasP</span>. <span class="id" type="var">exists</span> (<span class="id" type="constructor">Atom</span> <span class="id" type="var">a</span>).<br/>
        <span class="id" type="tactic">apply</span>/<span class="id" type="lemma">mapP</span>. <span class="id" type="var">exists</span> <span class="id" type="var">a</span> =&gt; //.<br/>
        <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">mem_filter</span>.<br/>
        <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">mem_enum</span> <span class="id" type="lemma">andbT</span> /= <span class="id" type="var">H0</span>.<br/>
      <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="lemma">in_simpl</span> /= <span class="id" type="lemma">eq_refl</span>.<br/>
    <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span>: <a class="idref" href="transitive_closure.html#L_R_1"><span class="id" type="lemma">L_R_1</span></a>.<br/>
  <span class="id" type="keyword">Qed</span>.<br/>
<br/>
<br/>
<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="transitive_closure.html#TransitiveClosure"><span class="id" type="section">TransitiveClosure</span></a>.<br/>
</div></section></section></section></section></section>
</div>
<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>
</div>
</body></html>
